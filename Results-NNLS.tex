\subsection{Comparison to single cell datasets}
A potential problem with profiling pools of sorted neurons is that two distinct types of neurons may be inadvertently profiled together if they are both labeled in the same brain region of the same strain. Single cell RNA-seq (SCRS) has recently emerged as a viable method for profiling cellular diversity in the nervous system and elsewhere, that does not suffer from this limitation. Profiles of cell types in SC studies are obtained by clustering and then summing cellular profiles. In order to assess the relative cellular homogeneity of our sorted samples we compared their profiles to cluster profiles from SCRS studies. We focused on neuronal and non-neuronal cell types in the neocortex, since two recent SCRS studies profiled this region (Tasic et al. 2015; Zeisel et al. 2015). Transcriptional homogeneity was computed by decomposing NeuroSeq profiles into SCRS cluster profiles using non-negative least squares (NNLS). As a check on the validity of the procedure, we decomposed summed profiles of multiple SCRS clusters obtained from a single transgenic lines in Tasic et al. The resulting coefficients (Figure 2 Supplement 1, left) very closely reproduced the reported fractions of cells of each type obtained from each transgenic strain (Figure 2 Supplement 1, right). As an additional check, we also constructed a random forest classifier (Breiman, 2001) to estimate the mixture ratio using the ratio of component tree votes (Figure 2 Supplement 2). This decomposition produced very similar results to that produced by NNLS, providing independent support for the validity of the decomposition. 

For each sorted cell type in the NeuroSeq dataset the procedure identifies the weight (coefficient) of each component cluster cell type in the SCRS datasets (Fig. 2A). Fully blue columns represent cell types profiled in the Tasic and Zeisel studies that could not be matched to NeuroSeq cell types. These included L4 neurons, VIP interneurons and oligodendrocytes which were not profiled in our study. 

Other cell types showed varying degree of matching, from perfect matches (microglia, astrocytes, ependyma) to decomposition into up to three SCRS clusters. We measured the uniqueness of the decomposition as a "purity" score defined as the ratio of the highest coefficient divided by the sum of all coefficients. Purity ranges from 0 to 1 and the score of 1 indicate a perfect match. Overall the purity scores for the decomposition of NeuroSeq cell types by the two SCRS datasets are higher than those obtained for SCRS cell clusters decomposed by the other SCRS data set (Figure 2B and Fig2 Supplement 3). Profiles with imperfect matches usually matched closely related cell types. For example, the NeuroSeq palvalbumin interneuron group matched one or two of the SCRS Pvalb-positive interneuron clusters, layer 2/3 (L2/3) pyramidal neurons matched SCRS L2/3 clusters, or an adjacent cluster in L4 (Tasic: L4 Arf5), etc. The spread of coefficients typically involved the same few SCRS cell clusters (e.g. columns Tasic: L5b Tph2 and L5b Cdh13; Zeisel: S1PyrL5 and S1PyrL6), which could occur if these clusters are not well separated. 

To better assess the degree of cluster separation, we first decomposed SCRS data sets by themselves (by randomly diving cells into two sets, and decomposing one by the other; Figure 2 Supplement 4) and it turned out that these similar clusters are often not well decomposed even by their own cluster sets. For example, Tasic L5b Cdh13 is very close to L5b Tph2 and cannot be well segregated. [CHECK whether these corresponds to their "graded" or "continuous" cell clusters]. Accordingly, most of NeuroSeq L5 groups are decomposed into these two SCRS clusters. 

To assess the degree of cluster separation more globally, we calculated the "separability" defined in Figure 2C for each pair of profiles in each data set (Figure 2D). In Figure 2D, upper row color is set to range from 0 to 1, so blue color indicates that the pair of clusters are touching or overlapping. As can be seen from Fig.2D, most of SCRS clusters are overlapping within layers or within interneuron subtypes. Within NeuroSeq dataset, only "touching" groups are these derived from a same mouse line (Gpr26) and harvested from L5 or L6b.  The lower row of Fig.2D uses colors which range from 0 to 10 showing the scale of the separabilities in a larger dynamic range. As can be seen from it, most of the NeuroSeq group pairs have separability larger than 10 but all of the SCRS pairs have separabilities less than 10.

In summary, NeuroSeq sorted cell groups are as homogeneous as SCRS clusters and have much higher separability compared to SCRS clusters. 









