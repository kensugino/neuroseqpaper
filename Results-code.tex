\subsection{Extracting a compact TF code}
In order to better understand how individual TFs encode information about profiled cell types, we extracted the most compact number of TFs needed to specify each of the profiled cell types (or in some cases, a set of highly similar cell types). We reasoned that the constraint of efficiency implicit in extracting a compact code would focus attention on the most important TFs for establishing or maintaining neuronal identity. We identified the TF exhibiting clear “On” and “Off” expression states, whose pattern of expression maximally distinguished cell types in our sample. We then split cell types into two groups in which the TF was “On” or “Off.” We repeated this process iteratively on each of the resulting groups, in each case identifying the best distinguishing TF and bisecting the cell types accordingly. In order to maximize the relevance of the extracted TFs and corresponding cell groups, at each stage we chose the TF producing a bisection most consistent with the expression patterns of all other genes. Moreover, to extract TFs working at each level of anatomical organization, we favored TFs that distinguished the bisected groups, but not their subgroups, so that TFs expressed across each anatomical level are prioritized (see methods).

The resulting extracted hierarchy of TFs corresponds to a decision tree () for efficiently classifying cell types.
TFs selected as nodes were frequently genes previously implicated in the development or maintenance of the distinguished cell types. For example, Foxg1, which split forebrain from other cell types, is known to be critically required for normal development of the telencephalon (Xuan et al. 1995; Danesin and Houart, 2012) and is known to function cell autonomously within the olfactory placode for the production of olfactory sensory neurons and all other cells in the olfactory lineage (Duggan et al. 2008). Note that the TF decision tree is based on adult expression, so the retinal ganglion cell (RGC) subtypes sampled are included in the Foxg1- group, even though Foxg1 is known to be expressed in the early eyecup and to contribute to RGC pathfinding (Schulte et al. 2005).

Most, but not all, nodal TFs are well known as key transcriptional regulators (KTRs) of the corresponding cell types in which they are expressed. For example, although level 2 and 3 genes Tbr1(), Satb2(), Egr3(), Isl1() and Emx2(), as well as most of the level 4 and 5 TFs, are known as KTRs involved in the development and/or maintenance of the relevant cell types, Tox2 has received little prior study in the CNS, although it has recently been identified and replicated as locus of heritability for Major Depressive Disorder (Zeng et al. 2016; PMID:28153336). Based on its position in the tree, we hypothesize that Tox2 is a KTR of midbrain, hypothalamic and hindbrain celltypes. Hence the list of nodal genes represents a rich source of novel hypotheses about transcriptional regulation in genetically identified cell types.

The arrangement of cell types along the decision tree reflects known major developmental relationships, but also deviates from those relationships, especially at lower levels of the hierarchy. For example, hindbrain cholinergic (HB-ACh) neurons are located closer to glutamatergic thalamic neurons (TH-glu)than are RGCs, despite the fact that RGCs are glutamatergic and diencephalic, like TH-glu neurons. This could reflect cases in which the same TF is reused as a KTR in multiple lineages, or could reflect a change in the expression of nodal TFs in a subset of cell types. We attempted to strengthen the relevance of the tree to the known relationships between cell types by constraining bisections to keep groups of cell types sharing the same anatomical subregion and neurotransmitter phenotype together. We found that we could easily construct such trees, if we relaxed the constraint of perfectly dividing groups by nodal TF expression. Such mismatches would arise if the expression of the nodal TF is not maintained, or is turned on later. An example tree with strengthened anatomical constraints is shown in Figure 5 Supplementary Figure 1. Many of the same TFs are identified in both trees. We also examined the effect of removing the anatomical constraint (Figure 5 Supplement 2) and again many of the same genes were selected, although, as expected, the tree deviated further from known anatomical relationships. Of the 129 nodal genes identified (78 shown in Fig. 5 and 51 additional genes with matching or perfectly complimentary expression patterns), 106 (82\%) and 79 (61\%) were identical in the trees with enhanced and no anatomical constraints respectively. The fact that 3/5 of the genes are identical even when no anatomical constraints are included suggests that most of the information used to select nodal genes is already present in expression patterns and does not require additional assumptions about functional anatomical relationships between cell types.

The construction of TF code tree utilized the wide sampling of the cell types in the current dataset as well as the "intersection method" which is a powerful way to extract genes relevant to a group of cell types. For example, in the above tree case, we prioritized selection of genes whose expression is consistent with anatomy. These shared genes are more likely to be the one which is kept expressed from the last common progenitors. This is the reason why nodal genes are enriched with developmentally important genes.

As another application which utilized wide sampling of cell types and intersection method, we  extracted pan-neuronal genes (Fig.5 Supp.3). These contain well known genes such as Eno2 (Enolase2), which is required for neuronal specific Crebs cycle, Slc2a3 (chrolide transporter) which is necessary in sensing inhibitory transmission, Atp1a3 ().....  Synaptic genes are often differentially expressed among neurons but the genes included in this pan-neuronal list such as Syn1, Stx1b, Stxbp1, Sv2a, Vamp2 signify common components of any neurons pinpointing toward essential parts of the complexes. In this sense, this pan-neuronal gene list represents a list of necessary components of any neurons.

In summary, we've demonstrated how to extract useful (biological) information from the current dataset by constructing a compact TF code in a decision tree form and by extracting pan-neuronal genes, yielding a number of known genes and new candidate genes likely important for the development and maintenance of these cell types.
