\subsection{Extracting a compact TF code}
In addition to identifying the most informative transcription factors across the entire set of cell types studied, we also identify the most informative TFs for individual cell types. To accomplish this, we extracted the most compact set of “On” or “Off” TFs needed to specify each cell types generating a hierarchy of TFs constituting a decision tree \cite{Saeys_2007} that efficiently classifies cell types\cite{Gabitto_2016}. At each level of the tree, TFs were chosen to optimimally bisect the set of cell types into two groups that differed maximally from each other in terms of their overall expression profile. To generate a classifier operating at each level of anatomical organization, we favored TFs that distinguished the bisected groups, but not their anatomical subgroups.

The selected TFs included many genes previously implicated as key transcriptional regulators (KTRs) in the development or maintenance of the distinguished cell types. For example, Foxg1, which split forebrain from other cell types, is known to be critically required for normal development of the telencephalon \cite{Xuan_1995}; \cite{Danesin_2012} and is known to function cell autonomously within the olfactory placode for the production of olfactory sensory neurons, as well as for all other cells in the olfactory lineage \cite{Duggan_2008}. (Note that the TF decision tree is based on adult expression, so the retinal ganglion cell (RGC) subtypes sampled are included in the Foxg1- group, even though Foxg1 is known to be expressed in the early eyecup and to contribute to RGC pathfinding \cite{Schulte_2005}). Similarly, at the next levels,  Tbr1\cite{Bedogni_2010}, Satb2\cite{Sweeney_2017}, Egr3\cite{Chandra_2015}, Isl1\cite{Lu_2013} and Emx2 \cite{Zhang_2016}, are known as KTRs involved in the development and/or maintenance of the relevant cell types, providing significant validation of this method.

The TF code identified for each cell type is not unique. First, additional TFs are consistent with the tree shown (see Supplementary Table X). Second, the details of the tree depend on the precise procedure used to extract it. We explored variant procedures that better preserved the known anatomical and developmental relationships between cell types (Figure 5 Supplement 1) as well as procedures that made no assumptions about these relationship whatsoever (Figure 5 Supplement 2). Interestingly, in each case, the majority of the same genes were identified, suggesting they encode cell type information that is robust to the precise methods used to extract them.

Although the decision tree classifier identifies many known KTRs, it also suggests hypotheses about less studied genes. For example, Tox2 has received little prior study in the CNS, although it has recently been identified and replicated as a locus of heritability for Major Depressive Disorder \cite{Zeng_2016}. Based on its position in the tree, we hypothesize that Tox2 is a KTR of midbrain, hypothalamic and hindbrain celltypes (including dopaminergic and serotonergic cell types in these regions). Hence the tree of identified TFs are a robust and rich source of novel hypotheses about transcriptional regulation in genetically identified cell types. Known and hypothesized KTRs identified by the decision tree classifier are tabulated in Supplementary Table X.