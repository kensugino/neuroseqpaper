\section*{Introduction}

The extraordinary diversity of vertebrate neurons has been appreciated since the proposal of the neuron doctrine \citep{Cajal_1888} [#fix ref]. Typically, this diversity is characterized by neuronal morphology, physiology, molecular expression, and circuit connectivity. The exact number of neuronal cell types remains unknown, but estimates of 40-60 have been provided for the retina \citep{Macosko_2015,Masland_2004} and for mouse cortex \citep{Tasic_2016,Zeisel_2015}. If similar numbers are discovered in most brain regions, the number could be in the thousands or more. Although neuronal diversity has long been recognized, the question of how this  diversity arises is only beginning to be asked \citep{Arendt_2008,Muotri_2006}. 

%Currently two techniques dominate the efforts to profile the transcriptional diversity of cell types in the brain: one is RNA-seq from single neurons, (single-cell RNA-seq; SCRS), \citep[e.g.][]{Shapiro_2013} and the other is from genetically or anatomically marked pools of neurons \citep[e.g.][]{Okaty_2015,Cembrowski_2016}.  An obvious advantage of the SCRS approach is that, by definition, each measurement comes from only a single cell type. However, SCRS measurements can be noisy and, depending on the approach, can have limited depth and sensitivity \citep{Parekh_2016,Svensson_2017}. So far, the field attempts to generate accurate and precise transcriptional profiles of cell types by clustering and then averaging the profiles of single cells. But the process of clustering itself can add noise \citep{Ntranos_2016}, and the unbiased nature of the measurement complicates the assessment of reproducibility. Pooling reduces noise, but can suffer from unknowingly lumping together more than one cell type. In the end, performing both methods will allow for a more confident assessment of the cell types of the brain. While large, unbiased single cell efforts have been completed or are underway, similar large scale efforts for genetically identified neurons have yet to be reported. 

To investigate diversity of neuronal transcriptomes, we performed RNA-seq on the largest set to date of genetically identified and fluorescently labeled pooled neurons from micro-dissected brain regions. In total, we profiled 179 neuronal cell types and 15 non-neuronal cell types and quantitatively compared our cortical profiles to those obtained in SCRS studies. (A more precise description of our use of the term "cell type" is provided in the Methods). To assess the homogeneity of the pooled samples, we compared the current dataset to publicly available single cell datasets, which revealed a comparable level of homogeneity, but a much lower level of noise in the bulk sorted profiles. 

To rigorously assess diversity in our dataset we adopt insights from the fields of ecology and economics [#fix ref {Simpson, 1949 #96; Hirschman, 1964 #97}], which have well-established metrics to assess diversity. From this we introduce two simple metrics that separate key features of the data. Signal contrast (SC) is a signal-to-noise ratio that (unlike ANOVA) is not sensitive to differences in information content. Differentiation index (DI), on the other hand, is a measure of information content closely related to mutual information. We find these two metrics have improved performance, and provide novel insights about the transcriptional logic of neuronal diversity. [# What do you mean by transcriptional "logic"? Feel ambiguous.])

We find different genes contribute to separability of cell types through high SC or high DI. Using SC, we find that homeobox transcription factors, more than any other gene family, have the lowest transcriptional noise. This lead us to hypothesize a role for chromatin where we indeed find that the promoter and gene body of these genes is more closed, likely explaining the tight control over “OFF” expression. Using DI, we find that the genes carrying the most information about cell types are neuronal effector genes like receptors, ion channels and cell adhesion molecules. Interestingly, we find that genes defined by high SC or high DI differ dramatically in their gene length. Genes with high SC (low noise) are short while genes with high DI are long. The finding that long genes contribute disproportionally to cellular diversity is consistent with the previous finding that long genes are preferentially expressed in the brain. However, it raises a conundrum. Long genes have documented costs in the form of metabolic and genome integrity, and yet they are widely expressed in the brain. Our findings suggest that their contribution to cellular diversity is a possible benefit counterbalancing the costs of long genes. Investigating further, we find that long genes have lengthened through insertions of transposable elements and contain a larger number of candidate regulatory regions identified by ATAC-seq that are also arrayed in more diverse patterns across neuronal cell types than in short genes. This supports a mechanism where mobile element insertions have provided genetic fodder to increase the diversity of transcription regulation, thus facilitating cellular diversity. Over evolution, brains that have become more complex and more reliant on cellular diversity maintain these long genes which continue to increase in length as the genes themselves age. In contrast, we find low noise genes appear to remain short, perhaps due to purifying selection because of their fundamental roles in early development, and also likely due to closed chromatin biasing against insertion events. 
[# Stick somewhere in above: that high SC genes (i.e. homeobox), though low in DI individually has high combined DI.]


Taken together we present an important new resource in mapping brain cell types including a method to compare and contextualize single cell RNA-seq datasets, implement a novel strategy to mine information from large surveys of cell types, and demonstrate the utility of this strategy in generating specific biological hypotheses[#Specifically which one?]. Deeper investigation revealed insights into the contribution of different gene classes to neuronal diversity, broad mechanisms regulating these genes differently, and a new evolutionary perspective on the cost-to-benefit balance driving gene length and neuronal diversity.





%We have curated these reproducible and precise expression profiles to serve as a look-up table for linking single cell and cell type expression profiles to genetic strains in which they can be repeatedly accessed. 

%Cell types are typically identified by performing differential expression analyses. Standard differential expression methods focus on signal variance but are influenced by both information content and robustness of differential expression. We introduced two simple metrics to separate out these features of the data. Signal contrast (SC) is a signal-to-noise ratio that (unlike ANOVA) is not sensitive to differences in information content. Differentiation index (DI) is a measure of information content closely related to mutual information. Using these metrics, we identify homeobox transcription factors (TF) as the gene family with the lowest noise and highest ability to distinguish cell types and use these and other TFs to construct a compact “code” for profiled neuronal cell types. We find that the effector genes carrying the most information about cell types are synaptic genes like receptors, ion channels and cell adhesion molecules. Interestingly, a common feature of these genes is their long genomic length, reflecting the increased number and length of their introns. 

%Long genes such as these have recently been recognized as sites of genomic instability \cite{Wei_2016}, and as contributors to multiple nervous system diseases \cite{Sugino_2014,Gabel_2015,Zylka_2015}. Given these hazards and the fact that long genes are metabolically expensive to produce \cite{Castillo_Davis_2002}, why should they be so prominent in the brain?

%Our ATAC-seq results indicate that long genes contain a larger number of candidate regulatory regions which are arrayed in more diverse patterns than found in short genes, suggesting the longer length of the genes may permit increased regulatory complexity.

%Our results suggest their length may permit increased regulatory complexity, with long genes containing a larger number of candidate regulatory regions identified by ATAC-seq arrayed in more diverse patterns across neuronal cell types than found in short genes. 

%Moreover, these long genes are elongated during evolution by insertions of mobile elements and a large portion of the candidate regulatory regions identified by ATAC-seq overlap with these mobile elements. Thus, the increased length of neuronal genes may provide a platform for evolution to fine-tune gene expression and thus diversify the cell types of the nervous system.
