\subsection{A compact TF code for neuronal identity}
In addition to identifying the most informative transcription factors across the entire set of cell types studied, we also identify the most informative TFs for individual cell types. To accomplish this, we extracted the most compact set of “ON” or “OFF” TFs needed to specify each cell type generating a hierarchy of TFs constituting a decision tree  \citep{Saeys_2007} that efficiently classifies cell types \citep{Gabitto_2016}. At each level of the tree, TFs were chosen to optimally bisect (by their expression level) the set of cell types into two groups that differed maximally from each other in terms of their overall expression profile (assessed within the full transcriptome). To generate a classifier operating at each level of anatomical organization, we favored TFs whose bisected groups are consistent with anatomical divisions (see Methods for details).

The selected TFs included many genes previously implicated as key transcriptional regulators (KTRs) in the development or maintenance of the distinguished cell types. For example, \textit{Foxg1}, which split forebrain from other cell types, is known to be critically required for normal development of the telencephalon \citep{Xuan_1995, Danesin_2012} and is known to function cell autonomously within the olfactory placode for the production of olfactory sensory neurons, as well as for all other cells in the olfactory lineage \citep{Duggan_2008}. 
%(Note that the TF decision tree is based on adult expression, so the retinal ganglion cell (RGC) subtypes sampled are included in the Foxg1$-$ group, even though \textit{Foxg1} is known to be expressed in the early eyecup and to contribute to RGC pathfinding \citep{Schulte_2005}). 
Similarly, at the next levels, \textit{Tbr1} \citep{Bedogni_2010}, \textit{Satb2} \cite{Leone_2014}, \textit{Egr3} \citep{Chandra_2015}, \textit{Isl1} \citep{Lu_2013} and \textit{Emx2} \citep{Zhang_2016}, are known as KTRs involved in the development and/or maintenance of the relevant cell types, providing significant validation of this method.

The TF code identified for each cell type is not unique. First, there are additional TFs that are consistent with the tree (see Supplementary Table 3). Second, past the first level (\textit{Foxg1}), TFs may be expressed outside of the cell types shown and so could contribute to encoding other expression differences. More generally, the details of the tree may depend on the precise procedure used to extract it. We explored variant procedures that better preserved the known anatomical and developmental relationships between cell types (Figure 5 Supplement 1) as well as procedures that made no assumptions about these relationship whatsoever (Figure 5 Supplement 2). Interestingly, in each case, the majority of the same genes were identified, suggesting they encode cell type information that is robust to the precise methods used to extract them.

Although the decision tree classifier identifies many known KTRs, it also suggests hypotheses about less studied genes. For example, \textit{Tox2} has received little prior study in the CNS, although it has recently been identified and replicated as a locus of heritability for Major Depressive Disorder \citep{Zeng_2016}. Based on its position in the tree, we hypothesize that \textit{Tox2} is a KTR of midbrain, hypothalamic and hindbrain cell types, including dopaminergic and serotonergic cell types in these regions, although its expression in other cell types may also contribute. Hence the tree of identified TFs is a robust and rich source of novel hypotheses about transcriptional regulation in genetically identified cell types. Known and hypothesized KTRs identified by the decision tree classifier are tabulated in Supplementary Table 3.

